name: NoMore Spam

on:
  issues:
    types: [opened]
  pull_request_target:
    types: [opened]
    
permissions:
  contents: read
  issues: write
  pull-requests: write
  models: read
  actions: write

jobs:
  spam-detection:
    runs-on: ubuntu-latest
    
    steps:
      - name: Detect and close spam
        uses: JohnsonRan/nomore-spam@main
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          ai-base-url: ${{ secrets.AI_BASE_URL }}
          ai-api-key: ${{ secrets.AI_API_KEY }}
          # 使用 GitHub Models 可用且稳定的模型，避免 Unknown model 报错
          ai-model: 'openai/gpt-4o'
          labels: 'bug,enhancement,question'
          analyze-file-changes: 'true'
          max-analysis-depth: 'normal'
          blacklist: ${{ secrets.BLACKLIST }} # 可选：黑名单用户列表
